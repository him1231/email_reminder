import{r as d,q as u,o as x,w as h,h as j,i as m,j as e,B as i,T as r,C as p,k as y,S as g,l as C,d as w,b as l}from"./index-CbYJMVzh.js";import{d as A}from"./Delete-ClO8GDCN.js";import{G as c}from"./Grid-Ci02xzul.js";import{I as D}from"./IconButton-D2leuxha.js";import"./index.esm-DxwDVbjq.js";const k=()=>{const[b,f]=d.useState([]),[S,q]=d.useState([]);return d.useEffect(()=>{const t=u(j(l,"email_queue"),h("status","==","pending"),x("createdAt","desc")),s=m(t,n=>f(n.docs.map(a=>({id:a.id,...a.data()}))),n=>console.error(n)),o=u(j(l,"email_queue"),h("status","!=","pending"),x("createdAt","desc")),v=m(o,n=>q(n.docs.map(a=>({id:a.id,...a.data()}))),n=>console.error(n));return()=>{s(),v()}},[]),e.jsxs(i,{children:[e.jsx(r,{variant:"h6",children:"Email Queue"}),e.jsxs(i,{mt:2,children:[e.jsx(r,{variant:"subtitle1",children:"Pending"}),e.jsx(c,{container:!0,spacing:2,children:b.map(t=>{var s;return e.jsx(c,{item:!0,xs:12,children:e.jsx(p,{children:e.jsx(y,{children:e.jsxs(g,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(i,{children:[e.jsx(r,{children:t.to}),e.jsx(r,{variant:"body2",color:"text.secondary",children:t.subject}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["Created: ",(s=t.createdAt)!=null&&s.toDate?t.createdAt.toDate().toString():String(t.createdAt)]})]}),e.jsx(i,{children:e.jsx(D,{size:"small",onClick:async()=>{if(confirm("Delete this queued email?"))try{await C(w(l,"email_queue",t.id))}catch(o){console.error(o),alert("Delete failed: "+o.message)}},children:e.jsx(A,{})})})]})})})},t.id)})})]}),e.jsxs(i,{mt:3,children:[e.jsx(r,{variant:"subtitle1",children:"Sent / Failed history"}),e.jsx(c,{container:!0,spacing:2,sx:{mt:1},children:S.map(t=>{var s;return e.jsx(c,{item:!0,xs:12,children:e.jsx(p,{children:e.jsx(y,{children:e.jsx(g,{direction:"row",justifyContent:"space-between",alignItems:"center",children:e.jsxs(i,{children:[e.jsx(r,{children:t.to}),e.jsx(r,{variant:"body2",color:"text.secondary",children:t.subject}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["Status: ",t.status," ",(s=t.sentAt)!=null&&s.toDate?`â€¢ Sent: ${t.sentAt.toDate().toString()}`:""]}),t.error&&e.jsxs(r,{variant:"caption",color:"error",children:["Error: ",t.error]})]})})})})},t.id)})})]})]})};export{k as EmailQueue};
