import{r as h,v as $,x as _,y as z,z as N,A as y,j as n,D as W,F as A,G as H,E as R,H as _e,J as V,I as ze,p as ee,t as te,a as Ne,h as le,q as We,o as ce,i as de,B as Ae,S as He,T as F,c as O,C as ue,k as me,a5 as Fe,a0 as Oe,b as I,f as fe,d as K,l as Ie,a8 as Ee}from"./index-CbYJMVzh.js";import{T as he,d as Xe}from"./Edit-BrHnZEaV.js";import{d as Ue}from"./Delete-ClO8GDCN.js";import{S as Ye}from"./Switch-A0YHhoKr.js";import{I as G}from"./IconButton-D2leuxha.js";import{D as ge,a as pe,b as ye,c as be}from"./DialogTitle-DtfCdj8f.js";import"./Grow-DtVAx6xa.js";import"./resolveComponentProps-CivoGKXj.js";import"./index.esm-DxwDVbjq.js";import"./Popper-DckpR7tz.js";import"./SwitchBase-C69rQmeF.js";const Pe=h.createContext();function qe(e){return $("MuiTable",e)}_("MuiTable",["root","stickyHeader"]);const Be=["className","component","padding","size","stickyHeader"],Le=e=>{const{classes:a,stickyHeader:t}=e;return A({root:["root",t&&"stickyHeader"]},qe,a)},Je=H("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,t.stickyHeader&&a.stickyHeader]}})(({theme:e,ownerState:a})=>y({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":y({},e.typography.body2,{padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},a.stickyHeader&&{borderCollapse:"separate"})),ve="table",Ve=h.forwardRef(function(a,t){const r=z({props:a,name:"MuiTable"}),{className:o,component:i=ve,padding:l="normal",size:s="medium",stickyHeader:d=!1}=r,u=N(r,Be),f=y({},r,{component:i,padding:l,size:s,stickyHeader:d}),v=Le(f),m=h.useMemo(()=>({padding:l,size:s,stickyHeader:d}),[l,s,d]);return n.jsx(Pe.Provider,{value:m,children:n.jsx(Je,y({as:i,role:i===ve?null:"table",ref:t,className:W(v.root,o),ownerState:f},u))})}),Q=h.createContext();function Qe(e){return $("MuiTableBody",e)}_("MuiTableBody",["root"]);const Ke=["className","component"],Ge=e=>{const{classes:a}=e;return A({root:["root"]},Qe,a)},Ze=H("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,a)=>a.root})({display:"table-row-group"}),et={variant:"body"},xe="tbody",tt=h.forwardRef(function(a,t){const r=z({props:a,name:"MuiTableBody"}),{className:o,component:i=xe}=r,l=N(r,Ke),s=y({},r,{component:i}),d=Ge(s);return n.jsx(Q.Provider,{value:et,children:n.jsx(Ze,y({className:W(d.root,o),as:i,ref:t,role:i===xe?null:"rowgroup",ownerState:s},l))})});function at(e){return $("MuiTableCell",e)}const nt=_("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),rt=["align","className","component","padding","scope","size","sortDirection","variant"],ot=e=>{const{classes:a,variant:t,align:r,padding:o,size:i,stickyHeader:l}=e,s={root:["root",t,l&&"stickyHeader",r!=="inherit"&&`align${R(r)}`,o!=="normal"&&`padding${R(o)}`,`size${R(i)}`]};return A(s,at,a)},st=H("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,a[t.variant],a[`size${R(t.size)}`],t.padding!=="normal"&&a[`padding${R(t.padding)}`],t.align!=="inherit"&&a[`align${R(t.align)}`],t.stickyHeader&&a.stickyHeader]}})(({theme:e,ownerState:a})=>y({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?_e(V(e.palette.divider,1),.88):ze(V(e.palette.divider,1),.68)}`,textAlign:"left",padding:16},a.variant==="head"&&{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},a.variant==="body"&&{color:(e.vars||e).palette.text.primary},a.variant==="footer"&&{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},a.size==="small"&&{padding:"6px 16px",[`&.${nt.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},a.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},a.padding==="none"&&{padding:0},a.align==="left"&&{textAlign:"left"},a.align==="center"&&{textAlign:"center"},a.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},a.align==="justify"&&{textAlign:"justify"},a.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default})),b=h.forwardRef(function(a,t){const r=z({props:a,name:"MuiTableCell"}),{align:o="inherit",className:i,component:l,padding:s,scope:d,size:u,sortDirection:f,variant:v}=r,m=N(r,rt),g=h.useContext(Pe),p=h.useContext(Q),w=p&&p.variant==="head";let D;l?D=l:D=w?"th":"td";let P=d;D==="td"?P=void 0:!P&&w&&(P="col");const U=v||p&&p.variant,Y=y({},r,{align:o,component:D,padding:s||(g&&g.padding?g.padding:"normal"),size:u||(g&&g.size?g.size:"medium"),sortDirection:f,stickyHeader:U==="head"&&g&&g.stickyHeader,variant:U}),c=ot(Y);let x=null;return f&&(x=f==="asc"?"ascending":"descending"),n.jsx(st,y({as:D,ref:t,className:W(c.root,i),"aria-sort":x,scope:P,ownerState:Y},m))});function it(e){return $("MuiTableContainer",e)}_("MuiTableContainer",["root"]);const lt=["className","component"],ct=e=>{const{classes:a}=e;return A({root:["root"]},it,a)},dt=H("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,a)=>a.root})({width:"100%",overflowX:"auto"}),ut=h.forwardRef(function(a,t){const r=z({props:a,name:"MuiTableContainer"}),{className:o,component:i="div"}=r,l=N(r,lt),s=y({},r,{component:i}),d=ct(s);return n.jsx(dt,y({ref:t,as:i,className:W(d.root,o),ownerState:s},l))});function mt(e){return $("MuiTableHead",e)}_("MuiTableHead",["root"]);const ft=["className","component"],ht=e=>{const{classes:a}=e;return A({root:["root"]},mt,a)},gt=H("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,a)=>a.root})({display:"table-header-group"}),pt={variant:"head"},we="thead",yt=h.forwardRef(function(a,t){const r=z({props:a,name:"MuiTableHead"}),{className:o,component:i=we}=r,l=N(r,ft),s=y({},r,{component:i}),d=ht(s);return n.jsx(Q.Provider,{value:pt,children:n.jsx(gt,y({as:i,className:W(d.root,o),ref:t,role:i===we?null:"rowgroup",ownerState:s},l))})});function bt(e){return $("MuiTableRow",e)}const Ce=_("MuiTableRow",["root","selected","hover","head","footer"]),vt=["className","component","hover","selected"],xt=e=>{const{classes:a,selected:t,hover:r,head:o,footer:i}=e;return A({root:["root",t&&"selected",r&&"hover",o&&"head",i&&"footer"]},bt,a)},wt=H("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,t.head&&a.head,t.footer&&a.footer]}})(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${Ce.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${Ce.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:V(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:V(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}})),Me="tr",Te=h.forwardRef(function(a,t){const r=z({props:a,name:"MuiTableRow"}),{className:o,component:i=Me,hover:l=!1,selected:s=!1}=r,d=N(r,vt),u=h.useContext(Q),f=y({},r,{component:i,hover:l,selected:s,head:u&&u.variant==="head",footer:u&&u.variant==="footer"}),v=xt(f);return n.jsx(wt,y({as:i,ref:t,className:W(v.root,o),role:i===Me?null:"row",ownerState:f},d))});var ae={},Ct=te;Object.defineProperty(ae,"__esModule",{value:!0});var Se=ae.default=void 0,Mt=Ct(ee()),Tt=n;Se=ae.default=(0,Mt.default)((0,Tt.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"ErrorOutline");var ne={},jt=te;Object.defineProperty(ne,"__esModule",{value:!0});var Re=ne.default=void 0,Dt=jt(ee()),kt=n;Re=ne.default=(0,Dt.default)((0,kt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");var re={},Pt=te;Object.defineProperty(re,"__esModule",{value:!0});var $e=re.default=void 0,St=Pt(ee()),Rt=n;$e=re.default=(0,St.default)((0,Rt.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow");const L=43200,je=1440,De=Symbol.for("constructDateFrom");function oe(e,a){return typeof e=="function"?e(a):e&&typeof e=="object"&&De in e?e[De](a):e instanceof Date?new e.constructor(a):new Date(a)}function j(e,a){return oe(e,e)}let $t={};function _t(){return $t}function ke(e){const a=j(e),t=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return t.setUTCFullYear(a.getFullYear()),+e-+t}function se(e,...a){const t=oe.bind(null,e||a.find(r=>typeof r=="object"));return a.map(t)}function J(e,a){const t=+j(e)-+j(a);return t<0?-1:t>0?1:t}function zt(e){return oe(e,Date.now())}function Nt(e,a,t){const[r,o]=se(t==null?void 0:t.in,e,a),i=r.getFullYear()-o.getFullYear(),l=r.getMonth()-o.getMonth();return i*12+l}function Wt(e){return a=>{const r=(e?Math[e]:Math.trunc)(a);return r===0?0:r}}function At(e,a){return+j(e)-+j(a)}function Ht(e,a){const t=j(e);return t.setHours(23,59,59,999),t}function Ft(e,a){const t=j(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Ot(e,a){const t=j(e);return+Ht(t)==+Ft(t)}function It(e,a,t){const[r,o,i]=se(t==null?void 0:t.in,e,e,a),l=J(o,i),s=Math.abs(Nt(o,i));if(s<1)return 0;o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-l*s);let d=J(o,i)===-l;Ot(r)&&s===1&&J(r,i)===1&&(d=!1);const u=l*(s-+d);return u===0?0:u}function Et(e,a,t){const r=At(e,a)/1e3;return Wt(t==null?void 0:t.roundingMethod)(r)}const Xt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ut=(e,a,t)=>{let r;const o=Xt[e];return typeof o=="string"?r=o:a===1?r=o.one:r=o.other.replace("{{count}}",a.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Z(e){return(a={})=>{const t=a.width?String(a.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const Yt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},qt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Bt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Lt={date:Z({formats:Yt,defaultWidth:"full"}),time:Z({formats:qt,defaultWidth:"full"}),dateTime:Z({formats:Bt,defaultWidth:"full"})},Jt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Vt=(e,a,t,r)=>Jt[e];function E(e){return(a,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let o;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,s=t!=null&&t.width?String(t.width):l;o=e.formattingValues[s]||e.formattingValues[l]}else{const l=e.defaultWidth,s=t!=null&&t.width?String(t.width):e.defaultWidth;o=e.values[s]||e.values[l]}const i=e.argumentCallback?e.argumentCallback(a):a;return o[i]}}const Qt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Kt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Gt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Zt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ea={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ta={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},aa=(e,a)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},na={ordinalNumber:aa,era:E({values:Qt,defaultWidth:"wide"}),quarter:E({values:Kt,defaultWidth:"wide",argumentCallback:e=>e-1}),month:E({values:Gt,defaultWidth:"wide"}),day:E({values:Zt,defaultWidth:"wide"}),dayPeriod:E({values:ea,defaultWidth:"wide",formattingValues:ta,defaultFormattingWidth:"wide"})};function X(e){return(a,t={})=>{const r=t.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=a.match(o);if(!i)return null;const l=i[0],s=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(s)?oa(s,v=>v.test(l)):ra(s,v=>v.test(l));let u;u=e.valueCallback?e.valueCallback(d):d,u=t.valueCallback?t.valueCallback(u):u;const f=a.slice(l.length);return{value:u,rest:f}}}function ra(e,a){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&a(e[t]))return t}function oa(e,a){for(let t=0;t<e.length;t++)if(a(e[t]))return t}function sa(e){return(a,t={})=>{const r=a.match(e.matchPattern);if(!r)return null;const o=r[0],i=a.match(e.parsePattern);if(!i)return null;let l=e.valueCallback?e.valueCallback(i[0]):i[0];l=t.valueCallback?t.valueCallback(l):l;const s=a.slice(o.length);return{value:l,rest:s}}}const ia=/^(\d+)(th|st|nd|rd)?/i,la=/\d+/i,ca={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},da={any:[/^b/i,/^(a|c)/i]},ua={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ma={any:[/1/i,/2/i,/3/i,/4/i]},fa={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ha={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ga={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pa={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ya={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ba={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},va={ordinalNumber:sa({matchPattern:ia,parsePattern:la,valueCallback:e=>parseInt(e,10)}),era:X({matchPatterns:ca,defaultMatchWidth:"wide",parsePatterns:da,defaultParseWidth:"any"}),quarter:X({matchPatterns:ua,defaultMatchWidth:"wide",parsePatterns:ma,defaultParseWidth:"any",valueCallback:e=>e+1}),month:X({matchPatterns:fa,defaultMatchWidth:"wide",parsePatterns:ha,defaultParseWidth:"any"}),day:X({matchPatterns:ga,defaultMatchWidth:"wide",parsePatterns:pa,defaultParseWidth:"any"}),dayPeriod:X({matchPatterns:ya,defaultMatchWidth:"any",parsePatterns:ba,defaultParseWidth:"any"})},xa={code:"en-US",formatDistance:Ut,formatLong:Lt,formatRelative:Vt,localize:na,match:va,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wa(e,a,t){const r=_t(),o=(t==null?void 0:t.locale)??r.locale??xa,i=2520,l=J(e,a);if(isNaN(l))throw new RangeError("Invalid time value");const s=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:l}),[d,u]=se(t==null?void 0:t.in,...l>0?[a,e]:[e,a]),f=Et(u,d),v=(ke(u)-ke(d))/1e3,m=Math.round((f-v)/60);let g;if(m<2)return t!=null&&t.includeSeconds?f<5?o.formatDistance("lessThanXSeconds",5,s):f<10?o.formatDistance("lessThanXSeconds",10,s):f<20?o.formatDistance("lessThanXSeconds",20,s):f<40?o.formatDistance("halfAMinute",0,s):f<60?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",1,s):m===0?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",m,s);if(m<45)return o.formatDistance("xMinutes",m,s);if(m<90)return o.formatDistance("aboutXHours",1,s);if(m<je){const p=Math.round(m/60);return o.formatDistance("aboutXHours",p,s)}else{if(m<i)return o.formatDistance("xDays",1,s);if(m<L){const p=Math.round(m/je);return o.formatDistance("xDays",p,s)}else if(m<L*2)return g=Math.round(m/L),o.formatDistance("aboutXMonths",g,s)}if(g=It(u,d),g<12){const p=Math.round(m/L);return o.formatDistance("xMonths",p,s)}else{const p=g%12,w=Math.trunc(g/12);return p<3?o.formatDistance("aboutXYears",w,s):p<9?o.formatDistance("overXYears",w,s):o.formatDistance("almostXYears",w+1,s)}}function Ca(e,a){return wa(e,zt(e),a)}const Na=()=>{const e=Ne(),a=c=>e(c),[t,r]=h.useState([]),[o,i]=h.useState({}),[l,s]=h.useState(!0),[d,u]=h.useState({open:!1});h.useEffect(()=>{const c=le(I,"rules"),x=We(c,ce("enabled","desc"),ce("name")),S=de(x,C=>{r(C.docs.map(M=>({id:M.id,...M.data()}))),s(!1)},C=>{console.error(C),s(!1)}),q=le(I,"templates"),B=de(q,C=>{const M={};C.docs.forEach(k=>{M[k.id]=k.data().name||k.data().subject||k.id}),i(M)});return()=>{S(),B()}},[]);const f=async(c,x)=>{try{await fe(K(I,"rules",c),{enabled:x})}catch(S){console.error("toggle error",S)}},[v,m]=h.useState(!1),[g,p]=h.useState(null),[w,D]=h.useState(""),P=(c,x)=>{p(c),D(x),m(!0)},U=async()=>{if(g)try{const c=new Date;c.setFullYear(c.getFullYear()-1),await fe(K(I,"rules",g),{lastTriggeredAt:Ee.fromDate(c),lastTriggeredStaff:[]}),alert(`Rule "${w}" will process existing documents on next workflow run (every 10 minutes).`),m(!1)}catch(c){console.error("Failed to trigger rule:",c),alert("Failed to trigger rule: "+c.message)}},Y=async()=>{if(d.id)try{await Ie(K(I,"rules",d.id)),u({open:!1})}catch(c){console.error(c),alert("Delete failed: "+c.message)}};return n.jsxs(Ae,{children:[n.jsxs(He,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[n.jsx(F,{variant:"h5",children:"Email Rules"}),n.jsx(O,{variant:"contained",onClick:()=>a("/rules/new"),children:"Create Rule"})]}),l?n.jsx(ue,{children:n.jsx(me,{sx:{display:"flex",justifyContent:"center"},children:n.jsx(Fe,{})})}):t.length===0?n.jsx(ue,{children:n.jsx(me,{children:n.jsx(F,{children:"No rules yet. Create your first rule!"})})}):n.jsx(ut,{component:Oe,children:n.jsxs(Ve,{children:[n.jsx(yt,{children:n.jsxs(Te,{children:[n.jsx(b,{children:"Enabled"}),n.jsx(b,{children:"Name"}),n.jsx(b,{children:"Trigger"}),n.jsx(b,{children:"Email"}),n.jsx(b,{children:"Last Triggered"}),n.jsx(b,{children:"Status"}),n.jsx(b,{children:"Actions"})]})}),n.jsx(tt,{children:t.map(c=>{var x,S,q,B,C,M,k,ie;return n.jsxs(Te,{hover:!0,onClick:()=>a(`/rules/${c.id}/edit`),sx:{cursor:"pointer"},children:[n.jsx(b,{onClick:T=>T.stopPropagation(),children:n.jsx(Ye,{checked:!!c.enabled,onChange:T=>{T.stopPropagation(),f(c.id,T.target.checked)}})}),n.jsx(b,{children:c.name}),n.jsxs(b,{children:[(x=c.trigger)==null?void 0:x.collection," ",(S=c.trigger)==null?void 0:S.event]}),n.jsx(b,{children:`Template: ${o[(q=c.emailConfig)==null?void 0:q.templateId]||((B=c.emailConfig)==null?void 0:B.templateId)||"—"}, Send: +${((M=(C=c.emailConfig)==null?void 0:C.relativeTime)==null?void 0:M.value)||"?"} ${((ie=(k=c.emailConfig)==null?void 0:k.relativeTime)==null?void 0:ie.unit)||""}`}),n.jsx(b,{children:c.lastTriggeredAt?Ca(c.lastTriggeredAt.toDate?c.lastTriggeredAt.toDate():new Date(c.lastTriggeredAt),{addSuffix:!0}):"Never"}),n.jsx(b,{children:c.lastError?n.jsx(he,{title:c.lastError,children:n.jsxs("span",{style:{color:"red",display:"inline-flex",alignItems:"center"},children:[n.jsx(Se,{fontSize:"small"})," ",c.lastError.slice(0,40)]})}):n.jsxs("span",{style:{color:"green",display:"inline-flex",alignItems:"center"},children:[n.jsx(Re,{fontSize:"small"})," OK"]})}),n.jsxs(b,{onClick:T=>T.stopPropagation(),children:[n.jsx(G,{size:"small",onClick:()=>a(`/rules/${c.id}/edit`),"aria-label":"edit",children:n.jsx(Xe,{fontSize:"small"})}),n.jsx(he,{title:"Trigger now (process existing documents)",children:n.jsx(G,{size:"small",onClick:T=>{T.stopPropagation(),P(c.id,c.name)},"aria-label":"trigger",children:n.jsx($e,{fontSize:"small"})})}),n.jsx(G,{size:"small",onClick:()=>u({open:!0,id:c.id,name:c.name}),"aria-label":"delete",children:n.jsx(Ue,{fontSize:"small"})})]})]},c.id)})})]})}),n.jsxs(ge,{open:d.open,onClose:()=>u({open:!1}),children:[n.jsx(pe,{children:"Delete rule"}),n.jsxs(ye,{children:["Delete “",d.name,"”? This cannot be undone."]}),n.jsxs(be,{children:[n.jsx(O,{onClick:()=>u({open:!1}),children:"Cancel"}),n.jsx(O,{color:"error",variant:"contained",onClick:Y,children:"Delete"})]})]}),n.jsxs(ge,{open:v,onClose:()=>m(!1),children:[n.jsx(pe,{children:"Trigger Rule Now?"}),n.jsxs(ye,{children:[n.jsxs(F,{children:["This will reset the rule's tracking and process ",n.jsx("strong",{children:"all existing documents"})," that match the criteria."]}),n.jsxs(F,{sx:{mt:2},children:["Rule: ",n.jsx("strong",{children:w})]}),n.jsx(F,{sx:{mt:1,color:"warning.main"},children:"⚠️ This may schedule many emails. The next workflow run (within 10 minutes) will process them."})]}),n.jsxs(be,{children:[n.jsx(O,{onClick:()=>m(!1),children:"Cancel"}),n.jsx(O,{onClick:U,variant:"contained",color:"warning",children:"Trigger Now"})]})]})]})};export{Na as RulesList,Na as default};
