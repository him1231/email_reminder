import{r as u,U as Jt,K as dt,V as tt,a4 as Xt,A as y,v as bt,x as mt,y as ht,z as Me,j as l,D as ee,E as C,F as xt,G as q,m as Qt,X as Ft,L as kt,J as Q,a0 as _t,p as Vt,t as Bt,T as Ht,B as Yt,S as Pt,c as St,a5 as Zt,a6 as Lt,h as ot,b as He,a7 as eo,a8 as Rt,a9 as to,n as Tt,s as oo}from"./index-CbYJMVzh.js";import{m as at}from"./mustache-lDDT9aR0.js";import{A as ao,b as De,i as Oe,o as At,c as ft,T as ze}from"./TextField-BgZTWqKq.js";import{C as ro}from"./Close-DHQnEFsM.js";import{P as Wt}from"./Popper-DckpR7tz.js";import{I as Ut}from"./IconButton-D2leuxha.js";import{C as gt,M as jt}from"./MenuItem-Cnk0G5Od.js";import{F as Dt}from"./FormControlLabel-BQKSWLAp.js";import"./Grow-DtVAx6xa.js";import"./resolveComponentProps-CivoGKXj.js";import"./index.esm-DxwDVbjq.js";import"./SwitchBase-C69rQmeF.js";const lo=e=>{const o=u.useRef({});return u.useEffect(()=>{o.current=e}),o.current};function zt(e){return typeof e.normalize<"u"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}function no(e={}){const{ignoreAccents:o=!0,ignoreCase:i=!0,limit:s,matchFrom:h="any",stringify:I,trim:b=!1}=e;return(c,{inputValue:m,getOptionLabel:O})=>{let P=b?m.trim():m;i&&(P=P.toLowerCase()),o&&(P=zt(P));const L=P?c.filter(_=>{let z=(I||O)(_);return i&&(z=z.toLowerCase()),o&&(z=zt(z)),h==="start"?z.indexOf(P)===0:z.indexOf(P)>-1}):c;return typeof s=="number"?L.slice(0,s):L}}function rt(e,o){for(let i=0;i<e.length;i+=1)if(o(e[i]))return i;return-1}const io=no(),Mt=5,so=e=>{var o;return e.current!==null&&((o=e.current.parentElement)==null?void 0:o.contains(document.activeElement))},co=[];function po(e){const{unstable_isActiveElementInListbox:o=so,unstable_classNamePrefix:i="Mui",autoComplete:s=!1,autoHighlight:h=!1,autoSelect:I=!1,blurOnSelect:b=!1,clearOnBlur:c=!e.freeSolo,clearOnEscape:m=!1,componentName:O="useAutocomplete",defaultValue:P=e.multiple?co:null,disableClearable:L=!1,disableCloseOnSelect:_=!1,disabled:z,disabledItemsFocusable:w=!1,disableListWrap:ue=!1,filterOptions:be=io,filterSelectedOptions:te=!1,freeSolo:V=!1,getOptionDisabled:G,getOptionKey:me,getOptionLabel:he=a=>{var t;return(t=a.label)!=null?t:a},groupBy:oe,handleHomeEndKeys:Y=!e.freeSolo,id:x,includeInputInList:B=!1,inputValue:T,isOptionEqualToValue:j=(a,t)=>a===t,multiple:g=!1,onChange:ae,onClose:H,onHighlightChange:ie,onInputChange:W,onOpen:de,open:xe,openOnFocus:S=!1,options:we,readOnly:Ce=!1,selectOnFocus:Ne=!e.freeSolo,value:We}=e,J=Jt(x);let F=he;F=a=>{const t=he(a);return typeof t!="string"?String(t):t};const Ee=u.useRef(!1),Ue=u.useRef(!0),D=u.useRef(null),X=u.useRef(null),[ke,lt]=u.useState(null),[U,Fe]=u.useState(-1),Ke=h?0:-1,N=u.useRef(Ke),[p,yt]=dt({controlled:We,default:P,name:O}),[$,fe]=dt({controlled:T,default:"",name:O,state:"inputValue"}),[Pe,qe]=u.useState(!1),ye=u.useCallback((a,t)=>{if(!(g?p.length<t.length:t!==null)&&!c)return;let n;if(g)n="";else if(t==null)n="";else{const f=F(t);n=typeof f=="string"?f:""}$!==n&&(fe(n),W&&W(a,n,"reset"))},[F,$,g,W,fe,c,p]),[ve,Ge]=dt({controlled:xe,default:!1,name:O,state:"open"}),[nt,Je]=u.useState(!0),Xe=!g&&p!=null&&$===F(p),K=ve&&!Ce,k=K?be(we.filter(a=>!(te&&(g?p:[p]).some(t=>t!==null&&j(a,t)))),{inputValue:Xe&&nt?"":$,getOptionLabel:F}):[],re=lo({filteredOptions:k,value:p,inputValue:$});u.useEffect(()=>{const a=p!==re.value;Pe&&!a||V&&!a||ye(null,p)},[p,ye,Pe,re.value,V]);const _e=ve&&k.length>0&&!Ce,Se=tt(a=>{a===-1?D.current.focus():ke.querySelector(`[data-tag-index="${a}"]`).focus()});u.useEffect(()=>{g&&U>p.length-1&&(Fe(-1),Se(-1))},[p,g,U,Se]);function Le(a,t){if(!X.current||a<0||a>=k.length)return-1;let r=a;for(;;){const n=X.current.querySelector(`[data-option-index="${r}"]`),f=w?!1:!n||n.disabled||n.getAttribute("aria-disabled")==="true";if(n&&n.hasAttribute("tabindex")&&!f)return r;if(t==="next"?r=(r+1)%k.length:r=(r-1+k.length)%k.length,r===a)return-1}}const se=tt(({event:a,index:t,reason:r="auto"})=>{if(N.current=t,t===-1?D.current.removeAttribute("aria-activedescendant"):D.current.setAttribute("aria-activedescendant",`${J}-option-${t}`),ie&&ie(a,t===-1?null:k[t],r),!X.current)return;const n=X.current.querySelector(`[role="option"].${i}-focused`);n&&(n.classList.remove(`${i}-focused`),n.classList.remove(`${i}-focusVisible`));let f=X.current;if(X.current.getAttribute("role")!=="listbox"&&(f=X.current.parentElement.querySelector('[role="listbox"]')),!f)return;if(t===-1){f.scrollTop=0;return}const R=X.current.querySelector(`[data-option-index="${t}"]`);if(R&&(R.classList.add(`${i}-focused`),r==="keyboard"&&R.classList.add(`${i}-focusVisible`),f.scrollHeight>f.clientHeight&&r!=="mouse"&&r!=="touch")){const A=R,pe=f.clientHeight+f.scrollTop,Ot=A.offsetTop+A.offsetHeight;Ot>pe?f.scrollTop=Ot-f.clientHeight:A.offsetTop-A.offsetHeight*(oe?1.3:0)<f.scrollTop&&(f.scrollTop=A.offsetTop-A.offsetHeight*(oe?1.3:0))}}),le=tt(({event:a,diff:t,direction:r="next",reason:n="auto"})=>{if(!K)return;const R=Le((()=>{const A=k.length-1;if(t==="reset")return Ke;if(t==="start")return 0;if(t==="end")return A;const pe=N.current+t;return pe<0?pe===-1&&B?-1:ue&&N.current!==-1||Math.abs(t)>1?0:A:pe>A?pe===A+1&&B?-1:ue||Math.abs(t)>1?A:0:pe})(),r);if(se({index:R,reason:n,event:a}),s&&t!=="reset")if(R===-1)D.current.value=$;else{const A=F(k[R]);D.current.value=A,A.toLowerCase().indexOf($.toLowerCase())===0&&$.length>0&&D.current.setSelectionRange($.length,A.length)}}),Re=()=>{const a=(t,r)=>{const n=t?F(t):"",f=r?F(r):"";return n===f};if(N.current!==-1&&re.filteredOptions&&re.filteredOptions.length!==k.length&&re.inputValue===$&&(g?p.length===re.value.length&&re.value.every((t,r)=>F(p[r])===F(t)):a(re.value,p))){const t=re.filteredOptions[N.current];if(t)return rt(k,r=>F(r)===F(t))}return-1},Ve=u.useCallback(()=>{if(!K)return;const a=Re();if(a!==-1){N.current=a;return}const t=g?p[0]:p;if(k.length===0||t==null){le({diff:"reset"});return}if(X.current){if(t!=null){const r=k[N.current];if(g&&r&&rt(p,f=>j(r,f))!==-1)return;const n=rt(k,f=>j(f,t));n===-1?le({diff:"reset"}):se({index:n});return}if(N.current>=k.length-1){se({index:k.length-1});return}se({index:N.current})}},[k.length,g?!1:p,te,le,se,K,$,g]),it=tt(a=>{Xt(X,a),a&&Ve()});u.useEffect(()=>{Ve()},[Ve]);const Z=a=>{ve||(Ge(!0),Je(!0),de&&de(a))},ge=(a,t)=>{ve&&(Ge(!1),H&&H(a,t))},ce=(a,t,r,n)=>{if(g){if(p.length===t.length&&p.every((f,R)=>f===t[R]))return}else if(p===t)return;ae&&ae(a,t,r,n),yt(t)},Te=u.useRef(!1),$e=(a,t,r="selectOption",n="options")=>{let f=r,R=t;if(g){R=Array.isArray(p)?p.slice():[];const A=rt(R,pe=>j(t,pe));A===-1?R.push(t):n!=="freeSolo"&&(R.splice(A,1),f="removeOption")}ye(a,R),ce(a,R,f,{option:t}),!_&&(!a||!a.ctrlKey&&!a.metaKey)&&ge(a,f),(b===!0||b==="touch"&&Te.current||b==="mouse"&&!Te.current)&&D.current.blur()};function Qe(a,t){if(a===-1)return-1;let r=a;for(;;){if(t==="next"&&r===p.length||t==="previous"&&r===-1)return-1;const n=ke.querySelector(`[data-tag-index="${r}"]`);if(!n||!n.hasAttribute("tabindex")||n.disabled||n.getAttribute("aria-disabled")==="true")r+=t==="next"?1:-1;else return r}}const Ye=(a,t)=>{if(!g)return;$===""&&ge(a,"toggleInput");let r=U;U===-1?$===""&&t==="previous"&&(r=p.length-1):(r+=t==="next"?1:-1,r<0&&(r=0),r===p.length&&(r=-1)),r=Qe(r,t),Fe(r),Se(r)},Ze=a=>{Ee.current=!0,fe(""),W&&W(a,"","clear"),ce(a,g?[]:null,"clear")},st=a=>t=>{if(a.onKeyDown&&a.onKeyDown(t),!t.defaultMuiPrevented&&(U!==-1&&["ArrowLeft","ArrowRight"].indexOf(t.key)===-1&&(Fe(-1),Se(-1)),t.which!==229))switch(t.key){case"Home":K&&Y&&(t.preventDefault(),le({diff:"start",direction:"next",reason:"keyboard",event:t}));break;case"End":K&&Y&&(t.preventDefault(),le({diff:"end",direction:"previous",reason:"keyboard",event:t}));break;case"PageUp":t.preventDefault(),le({diff:-Mt,direction:"previous",reason:"keyboard",event:t}),Z(t);break;case"PageDown":t.preventDefault(),le({diff:Mt,direction:"next",reason:"keyboard",event:t}),Z(t);break;case"ArrowDown":t.preventDefault(),le({diff:1,direction:"next",reason:"keyboard",event:t}),Z(t);break;case"ArrowUp":t.preventDefault(),le({diff:-1,direction:"previous",reason:"keyboard",event:t}),Z(t);break;case"ArrowLeft":Ye(t,"previous");break;case"ArrowRight":Ye(t,"next");break;case"Enter":if(N.current!==-1&&K){const r=k[N.current],n=G?G(r):!1;if(t.preventDefault(),n)return;$e(t,r,"selectOption"),s&&D.current.setSelectionRange(D.current.value.length,D.current.value.length)}else V&&$!==""&&Xe===!1&&(g&&t.preventDefault(),$e(t,$,"createOption","freeSolo"));break;case"Escape":K?(t.preventDefault(),t.stopPropagation(),ge(t,"escape")):m&&($!==""||g&&p.length>0)&&(t.preventDefault(),t.stopPropagation(),Ze(t));break;case"Backspace":if(g&&!Ce&&$===""&&p.length>0){const r=U===-1?p.length-1:U,n=p.slice();n.splice(r,1),ce(t,n,"removeOption",{option:p[r]})}break;case"Delete":if(g&&!Ce&&$===""&&p.length>0&&U!==-1){const r=U,n=p.slice();n.splice(r,1),ce(t,n,"removeOption",{option:p[r]})}break}},$t=a=>{qe(!0),S&&!Ee.current&&Z(a)},Ae=a=>{if(o(X)){D.current.focus();return}qe(!1),Ue.current=!0,Ee.current=!1,I&&N.current!==-1&&K?$e(a,k[N.current],"blur"):I&&V&&$!==""?$e(a,$,"blur","freeSolo"):c&&ye(a,p),ge(a,"blur")},E=a=>{const t=a.target.value;$!==t&&(fe(t),Je(!1),W&&W(a,t,"input")),t===""?!L&&!g&&ce(a,null,"clear"):Z(a)},M=a=>{const t=Number(a.currentTarget.getAttribute("data-option-index"));N.current!==t&&se({event:a,index:t,reason:"mouse"})},ne=a=>{se({event:a,index:Number(a.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Te.current=!0},It=a=>{const t=Number(a.currentTarget.getAttribute("data-option-index"));$e(a,k[t],"selectOption"),Te.current=!1},ct=a=>t=>{const r=p.slice();r.splice(a,1),ce(t,r,"removeOption",{option:p[a]})},pt=a=>{ve?ge(a,"toggleInput"):Z(a)},ut=a=>{a.currentTarget.contains(a.target)&&a.target.getAttribute("id")!==J&&a.preventDefault()},et=a=>{a.currentTarget.contains(a.target)&&(D.current.focus(),Ne&&Ue.current&&D.current.selectionEnd-D.current.selectionStart===0&&D.current.select(),Ue.current=!1)},Be=a=>{!z&&($===""||!ve)&&pt(a)};let Ie=V&&$.length>0;Ie=Ie||(g?p.length>0:p!==null);let je=k;return oe&&(je=k.reduce((a,t,r)=>{const n=oe(t);return a.length>0&&a[a.length-1].group===n?a[a.length-1].options.push(t):a.push({key:r,index:r,group:n,options:[t]}),a},[])),z&&Pe&&Ae(),{getRootProps:(a={})=>y({"aria-owns":_e?`${J}-listbox`:null},a,{onKeyDown:st(a),onMouseDown:ut,onClick:et}),getInputLabelProps:()=>({id:`${J}-label`,htmlFor:J}),getInputProps:()=>({id:J,value:$,onBlur:Ae,onFocus:$t,onChange:E,onMouseDown:Be,"aria-activedescendant":K?"":null,"aria-autocomplete":s?"both":"list","aria-controls":_e?`${J}-listbox`:void 0,"aria-expanded":_e,autoComplete:"off",ref:D,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:z}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Ze}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:pt}),getTagProps:({index:a})=>y({key:a,"data-tag-index":a,tabIndex:-1},!Ce&&{onDelete:ct(a)}),getListboxProps:()=>({role:"listbox",id:`${J}-listbox`,"aria-labelledby":`${J}-label`,ref:it,onMouseDown:a=>{a.preventDefault()}}),getOptionProps:({index:a,option:t})=>{var r;const n=(g?p:[p]).some(R=>R!=null&&j(t,R)),f=G?G(t):!1;return{key:(r=me==null?void 0:me(t))!=null?r:F(t),tabIndex:-1,role:"option",id:`${J}-option-${a}`,onMouseMove:M,onClick:It,onTouchStart:ne,"data-option-index":a,"aria-disabled":f,"aria-selected":n}},id:J,inputValue:$,value:p,dirty:Ie,expanded:K&&ke,popupOpen:K,focused:Pe||U!==-1,anchorEl:ke,setAnchorEl:lt,focusedTag:U,groupedOptions:je}}function uo(e){return bt("MuiListSubheader",e)}mt("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const fo=["className","color","component","disableGutters","disableSticky","inset"],go=e=>{const{classes:o,color:i,disableGutters:s,inset:h,disableSticky:I}=e,b={root:["root",i!=="default"&&`color${C(i)}`,!s&&"gutters",h&&"inset",!I&&"sticky"]};return xt(b,uo,o)},bo=q("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.root,i.color!=="default"&&o[`color${C(i.color)}`],!i.disableGutters&&o.gutters,i.inset&&o.inset,!i.disableSticky&&o.sticky]}})(({theme:e,ownerState:o})=>y({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14)},o.color==="primary"&&{color:(e.vars||e).palette.primary.main},o.color==="inherit"&&{color:"inherit"},!o.disableGutters&&{paddingLeft:16,paddingRight:16},o.inset&&{paddingLeft:72},!o.disableSticky&&{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper})),Kt=u.forwardRef(function(o,i){const s=ht({props:o,name:"MuiListSubheader"}),{className:h,color:I="default",component:b="li",disableGutters:c=!1,disableSticky:m=!1,inset:O=!1}=s,P=Me(s,fo),L=y({},s,{color:I,component:b,disableGutters:c,disableSticky:m,inset:O}),_=go(L);return l.jsx(bo,y({as:b,className:ee(_.root,h),ref:i,ownerState:L},P))});Kt.muiSkipListHighlight=!0;const mo=Qt(l.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function ho(e){return bt("MuiChip",e)}const v=mt("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),xo=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],vo=e=>{const{classes:o,disabled:i,size:s,color:h,iconColor:I,onDelete:b,clickable:c,variant:m}=e,O={root:["root",m,i&&"disabled",`size${C(s)}`,`color${C(h)}`,c&&"clickable",c&&`clickableColor${C(h)}`,b&&"deletable",b&&`deletableColor${C(h)}`,`${m}${C(h)}`],label:["label",`label${C(s)}`],avatar:["avatar",`avatar${C(s)}`,`avatarColor${C(h)}`],icon:["icon",`icon${C(s)}`,`iconColor${C(I)}`],deleteIcon:["deleteIcon",`deleteIcon${C(s)}`,`deleteIconColor${C(h)}`,`deleteIcon${C(m)}Color${C(h)}`]};return xt(O,ho,o)},Co=q("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e,{color:s,iconColor:h,clickable:I,onDelete:b,size:c,variant:m}=i;return[{[`& .${v.avatar}`]:o.avatar},{[`& .${v.avatar}`]:o[`avatar${C(c)}`]},{[`& .${v.avatar}`]:o[`avatarColor${C(s)}`]},{[`& .${v.icon}`]:o.icon},{[`& .${v.icon}`]:o[`icon${C(c)}`]},{[`& .${v.icon}`]:o[`iconColor${C(h)}`]},{[`& .${v.deleteIcon}`]:o.deleteIcon},{[`& .${v.deleteIcon}`]:o[`deleteIcon${C(c)}`]},{[`& .${v.deleteIcon}`]:o[`deleteIconColor${C(s)}`]},{[`& .${v.deleteIcon}`]:o[`deleteIcon${C(m)}Color${C(s)}`]},o.root,o[`size${C(c)}`],o[`color${C(s)}`],I&&o.clickable,I&&s!=="default"&&o[`clickableColor${C(s)})`],b&&o.deletable,b&&s!=="default"&&o[`deletableColor${C(s)}`],o[m],o[`${m}${C(s)}`]]}})(({theme:e,ownerState:o})=>{const i=e.palette.mode==="light"?e.palette.grey[700]:e.palette.grey[300];return y({maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${v.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${v.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:i,fontSize:e.typography.pxToRem(12)},[`& .${v.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${v.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${v.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${v.icon}`]:y({marginLeft:5,marginRight:-6},o.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},o.iconColor===o.color&&y({color:e.vars?e.vars.palette.Chip.defaultIconColor:i},o.color!=="default"&&{color:"inherit"})),[`& .${v.deleteIcon}`]:y({WebkitTapHighlightColor:"transparent",color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.26)`:Q(e.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:Q(e.palette.text.primary,.4)}},o.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},o.color!=="default"&&{color:e.vars?`rgba(${e.vars.palette[o.color].contrastTextChannel} / 0.7)`:Q(e.palette[o.color].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[o.color].contrastText}})},o.size==="small"&&{height:24},o.color!=="default"&&{backgroundColor:(e.vars||e).palette[o.color].main,color:(e.vars||e).palette[o.color].contrastText},o.onDelete&&{[`&.${v.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Q(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},o.onDelete&&o.color!=="default"&&{[`&.${v.focusVisible}`]:{backgroundColor:(e.vars||e).palette[o.color].dark}})},({theme:e,ownerState:o})=>y({},o.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Q(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)},[`&.${v.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Q(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},"&:active":{boxShadow:(e.vars||e).shadows[1]}},o.clickable&&o.color!=="default"&&{[`&:hover, &.${v.focusVisible}`]:{backgroundColor:(e.vars||e).palette[o.color].dark}}),({theme:e,ownerState:o})=>y({},o.variant==="outlined"&&{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${v.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${v.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${v.avatar}`]:{marginLeft:4},[`& .${v.avatarSmall}`]:{marginLeft:2},[`& .${v.icon}`]:{marginLeft:4},[`& .${v.iconSmall}`]:{marginLeft:2},[`& .${v.deleteIcon}`]:{marginRight:5},[`& .${v.deleteIconSmall}`]:{marginRight:3}},o.variant==="outlined"&&o.color!=="default"&&{color:(e.vars||e).palette[o.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / 0.7)`:Q(e.palette[o.color].main,.7)}`,[`&.${v.clickable}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Q(e.palette[o.color].main,e.palette.action.hoverOpacity)},[`&.${v.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / ${e.vars.palette.action.focusOpacity})`:Q(e.palette[o.color].main,e.palette.action.focusOpacity)},[`& .${v.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[o.color].mainChannel} / 0.7)`:Q(e.palette[o.color].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[o.color].main}}})),yo=q("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,o)=>{const{ownerState:i}=e,{size:s}=i;return[o.label,o[`label${C(s)}`]]}})(({ownerState:e})=>y({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},e.variant==="outlined"&&{paddingLeft:11,paddingRight:11},e.size==="small"&&{paddingLeft:8,paddingRight:8},e.size==="small"&&e.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function wt(e){return e.key==="Backspace"||e.key==="Delete"}const $o=u.forwardRef(function(o,i){const s=ht({props:o,name:"MuiChip"}),{avatar:h,className:I,clickable:b,color:c="default",component:m,deleteIcon:O,disabled:P=!1,icon:L,label:_,onClick:z,onDelete:w,onKeyDown:ue,onKeyUp:be,size:te="medium",variant:V="filled",tabIndex:G,skipFocusWhenDisabled:me=!1}=s,he=Me(s,xo),oe=u.useRef(null),Y=Ft(oe,i),x=S=>{S.stopPropagation(),w&&w(S)},B=S=>{S.currentTarget===S.target&&wt(S)&&S.preventDefault(),ue&&ue(S)},T=S=>{S.currentTarget===S.target&&(w&&wt(S)?w(S):S.key==="Escape"&&oe.current&&oe.current.blur()),be&&be(S)},j=b!==!1&&z?!0:b,g=j||w?kt:m||"div",ae=y({},s,{component:g,disabled:P,size:te,color:c,iconColor:u.isValidElement(L)&&L.props.color||c,onDelete:!!w,clickable:j,variant:V}),H=vo(ae),ie=g===kt?y({component:m||"div",focusVisibleClassName:H.focusVisible},w&&{disableRipple:!0}):{};let W=null;w&&(W=O&&u.isValidElement(O)?u.cloneElement(O,{className:ee(O.props.className,H.deleteIcon),onClick:x}):l.jsx(mo,{className:ee(H.deleteIcon),onClick:x}));let de=null;h&&u.isValidElement(h)&&(de=u.cloneElement(h,{className:ee(H.avatar,h.props.className)}));let xe=null;return L&&u.isValidElement(L)&&(xe=u.cloneElement(L,{className:ee(H.icon,L.props.className)})),l.jsxs(Co,y({as:g,className:ee(H.root,I),disabled:j&&P?!0:void 0,onClick:z,onKeyDown:B,onKeyUp:T,ref:Y,tabIndex:me&&P?-1:G,ownerState:ae},ie,he,{children:[de||xe,l.jsx(yo,{className:ee(H.label),ownerState:ae,children:_}),W]}))});function Io(e){return bt("MuiAutocomplete",e)}const d=mt("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var Nt,Et;const Oo=["autoComplete","autoHighlight","autoSelect","blurOnSelect","ChipProps","className","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","componentsProps","defaultValue","disableClearable","disableCloseOnSelect","disabled","disabledItemsFocusable","disableListWrap","disablePortal","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","fullWidth","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","isOptionEqualToValue","groupBy","handleHomeEndKeys","id","includeInputInList","inputValue","limitTags","ListboxComponent","ListboxProps","loading","loadingText","multiple","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","PaperComponent","PopperComponent","popupIcon","readOnly","renderGroup","renderInput","renderOption","renderTags","selectOnFocus","size","slotProps","value"],ko=["ref"],Po=["key"],So=["key"],Lo=e=>{const{classes:o,disablePortal:i,expanded:s,focused:h,fullWidth:I,hasClearIcon:b,hasPopupIcon:c,inputFocused:m,popupOpen:O,size:P}=e,L={root:["root",s&&"expanded",h&&"focused",I&&"fullWidth",b&&"hasClearIcon",c&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",m&&"inputFocused"],tag:["tag",`tagSize${C(P)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",O&&"popupIndicatorOpen"],popper:["popper",i&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return xt(L,Io,o)},Ro=q("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e,{fullWidth:s,hasClearIcon:h,hasPopupIcon:I,inputFocused:b,size:c}=i;return[{[`& .${d.tag}`]:o.tag},{[`& .${d.tag}`]:o[`tagSize${C(c)}`]},{[`& .${d.inputRoot}`]:o.inputRoot},{[`& .${d.input}`]:o.input},{[`& .${d.input}`]:b&&o.inputFocused},o.root,s&&o.fullWidth,I&&o.hasPopupIcon,h&&o.hasClearIcon]}})({[`&.${d.focused} .${d.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${d.clearIndicator}`]:{visibility:"visible"}},[`& .${d.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${d.inputRoot}`]:{[`.${d.hasPopupIcon}&, .${d.hasClearIcon}&`]:{paddingRight:30},[`.${d.hasPopupIcon}.${d.hasClearIcon}&`]:{paddingRight:56},[`& .${d.input}`]:{width:0,minWidth:30}},[`& .${ft.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${ft.root}.${Oe.sizeSmall}`]:{[`& .${ft.input}`]:{padding:"2px 4px 3px 0"}},[`& .${At.root}`]:{padding:9,[`.${d.hasPopupIcon}&, .${d.hasClearIcon}&`]:{paddingRight:39},[`.${d.hasPopupIcon}.${d.hasClearIcon}&`]:{paddingRight:65},[`& .${d.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${d.endAdornment}`]:{right:9}},[`& .${At.root}.${Oe.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${d.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${De.root}`]:{paddingTop:19,paddingLeft:8,[`.${d.hasPopupIcon}&, .${d.hasClearIcon}&`]:{paddingRight:39},[`.${d.hasPopupIcon}.${d.hasClearIcon}&`]:{paddingRight:65},[`& .${De.input}`]:{padding:"7px 4px"},[`& .${d.endAdornment}`]:{right:9}},[`& .${De.root}.${Oe.sizeSmall}`]:{paddingBottom:1,[`& .${De.input}`]:{padding:"2.5px 4px"}},[`& .${Oe.hiddenLabel}`]:{paddingTop:8},[`& .${De.root}.${Oe.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${d.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${De.root}.${Oe.hiddenLabel}.${Oe.sizeSmall}`]:{[`& .${d.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${d.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${d.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${d.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${d.inputRoot}`]:{flexWrap:"wrap"}}}]}),To=q("div",{name:"MuiAutocomplete",slot:"EndAdornment",overridesResolver:(e,o)=>o.endAdornment})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),Ao=q(Ut,{name:"MuiAutocomplete",slot:"ClearIndicator",overridesResolver:(e,o)=>o.clearIndicator})({marginRight:-2,padding:4,visibility:"hidden"}),jo=q(Ut,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:({ownerState:e},o)=>y({},o.popupIndicator,e.popupOpen&&o.popupIndicatorOpen)})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),Do=q(Wt,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[{[`& .${d.option}`]:o.option},o.popper,i.disablePortal&&o.popperDisablePortal]}})(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]})),zo=q(_t,{name:"MuiAutocomplete",slot:"Paper",overridesResolver:(e,o)=>o.paper})(({theme:e})=>y({},e.typography.body1,{overflow:"auto"})),Mo=q("div",{name:"MuiAutocomplete",slot:"Loading",overridesResolver:(e,o)=>o.loading})(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"})),wo=q("div",{name:"MuiAutocomplete",slot:"NoOptions",overridesResolver:(e,o)=>o.noOptions})(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"})),No=q("div",{name:"MuiAutocomplete",slot:"Listbox",overridesResolver:(e,o)=>o.listbox})(({theme:e})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${d.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${d.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${d.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Q(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${d.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Q(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${d.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Q(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}}}})),Eo=q(Kt,{name:"MuiAutocomplete",slot:"GroupLabel",overridesResolver:(e,o)=>o.groupLabel})(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8})),Fo=q("ul",{name:"MuiAutocomplete",slot:"GroupUl",overridesResolver:(e,o)=>o.groupUl})({padding:0,[`& .${d.option}`]:{paddingLeft:24}}),_o=u.forwardRef(function(o,i){var s,h,I,b;const c=ht({props:o,name:"MuiAutocomplete"}),{autoComplete:m=!1,autoHighlight:O=!1,autoSelect:P=!1,blurOnSelect:L=!1,ChipProps:_,className:z,clearIcon:w=Nt||(Nt=l.jsx(ro,{fontSize:"small"})),clearOnBlur:ue=!c.freeSolo,clearOnEscape:be=!1,clearText:te="Clear",closeText:V="Close",componentsProps:G={},defaultValue:me=c.multiple?[]:null,disableClearable:he=!1,disableCloseOnSelect:oe=!1,disabled:Y=!1,disabledItemsFocusable:x=!1,disableListWrap:B=!1,disablePortal:T=!1,filterSelectedOptions:j=!1,forcePopupIcon:g="auto",freeSolo:ae=!1,fullWidth:H=!1,getLimitTagsText:ie=t=>`+${t}`,getOptionLabel:W,groupBy:de,handleHomeEndKeys:xe=!c.freeSolo,includeInputInList:S=!1,limitTags:we=-1,ListboxComponent:Ce="ul",ListboxProps:Ne,loading:We=!1,loadingText:J="Loadingâ€¦",multiple:F=!1,noOptionsText:Ee="No options",openOnFocus:Ue=!1,openText:D="Open",PaperComponent:X=_t,PopperComponent:ke=Wt,popupIcon:lt=Et||(Et=l.jsx(ao,{})),readOnly:U=!1,renderGroup:Fe,renderInput:Ke,renderOption:N,renderTags:p,selectOnFocus:yt=!c.freeSolo,size:$="medium",slotProps:fe={}}=c,Pe=Me(c,Oo),{getRootProps:qe,getInputProps:ye,getInputLabelProps:ve,getPopupIndicatorProps:Ge,getClearProps:nt,getTagProps:Je,getListboxProps:Xe,getOptionProps:K,value:k,dirty:re,expanded:_e,id:Se,popupOpen:Le,focused:se,focusedTag:le,anchorEl:Re,setAnchorEl:Ve,inputValue:it,groupedOptions:Z}=po(y({},c,{componentName:"Autocomplete"})),ge=!he&&!Y&&re&&!U,ce=(!ae||g===!0)&&g!==!1,{onMouseDown:Te}=ye(),{ref:$e}=Ne??{},Qe=Xe(),{ref:Ye}=Qe,Ze=Me(Qe,ko),st=Ft(Ye,$e),Ae=W||(t=>{var r;return(r=t.label)!=null?r:t}),E=y({},c,{disablePortal:T,expanded:_e,focused:se,fullWidth:H,getOptionLabel:Ae,hasClearIcon:ge,hasPopupIcon:ce,inputFocused:le===-1,popupOpen:Le,size:$}),M=Lo(E);let ne;if(F&&k.length>0){const t=r=>y({className:M.tag,disabled:Y},Je(r));p?ne=p(k,t,E):ne=k.map((r,n)=>{const f=t({index:n}),{key:R}=f,A=Me(f,Po);return l.jsx($o,y({label:Ae(r),size:$},A,_),R)})}if(we>-1&&Array.isArray(ne)){const t=ne.length-we;!se&&t>0&&(ne=ne.splice(0,we),ne.push(l.jsx("span",{className:M.tag,children:ie(t)},ne.length)))}const ct=Fe||(t=>l.jsxs("li",{children:[l.jsx(Eo,{className:M.groupLabel,ownerState:E,component:"div",children:t.group}),l.jsx(Fo,{className:M.groupUl,ownerState:E,children:t.children})]},t.key)),ut=N||((t,r)=>{const{key:n}=t,f=Me(t,So);return l.jsx("li",y({},f,{children:Ae(r)}),n)}),et=(t,r)=>{const n=K({option:t,index:r});return ut(y({},n,{className:M.option}),t,{selected:n["aria-selected"],index:r,inputValue:it},E)},Be=(s=fe.clearIndicator)!=null?s:G.clearIndicator,Ie=(h=fe.paper)!=null?h:G.paper,je=(I=fe.popper)!=null?I:G.popper,a=(b=fe.popupIndicator)!=null?b:G.popupIndicator;return l.jsxs(u.Fragment,{children:[l.jsx(Ro,y({ref:i,className:ee(M.root,z),ownerState:E},qe(Pe),{children:Ke({id:Se,disabled:Y,fullWidth:!0,size:$==="small"?"small":void 0,InputLabelProps:ve(),InputProps:y({ref:Ve,className:M.inputRoot,startAdornment:ne,onClick:t=>{t.target===t.currentTarget&&Te(t)}},(ge||ce)&&{endAdornment:l.jsxs(To,{className:M.endAdornment,ownerState:E,children:[ge?l.jsx(Ao,y({},nt(),{"aria-label":te,title:te,ownerState:E},Be,{className:ee(M.clearIndicator,Be==null?void 0:Be.className),children:w})):null,ce?l.jsx(jo,y({},Ge(),{disabled:Y,"aria-label":Le?V:D,title:Le?V:D,ownerState:E},a,{className:ee(M.popupIndicator,a==null?void 0:a.className),children:lt})):null]})}),inputProps:y({className:M.input,disabled:Y,readOnly:U},ye())})})),Re?l.jsx(Do,y({as:ke,disablePortal:T,style:{width:Re?Re.clientWidth:null},ownerState:E,role:"presentation",anchorEl:Re,open:Le},je,{className:ee(M.popper,je==null?void 0:je.className),children:l.jsxs(zo,y({ownerState:E,as:X},Ie,{className:ee(M.paper,Ie==null?void 0:Ie.className),children:[We&&Z.length===0?l.jsx(Mo,{className:M.loading,ownerState:E,children:J}):null,Z.length===0&&!ae&&!We?l.jsx(wo,{className:M.noOptions,ownerState:E,role:"presentation",onMouseDown:t=>{t.preventDefault()},children:Ee}):null,Z.length>0?l.jsx(No,y({as:Ce,className:M.listbox,ownerState:E},Ze,Ne,{ref:st,children:Z.map((t,r)=>de?ct({key:t.key,group:t.group,children:t.options.map((n,f)=>et(n,t.index+f))}):et(t,r))})):null]}))})):null]})});var vt={},Vo=Bt;Object.defineProperty(vt,"__esModule",{value:!0});var qt=vt.default=void 0,Bo=Vo(Vt()),Ho=l;qt=vt.default=(0,Bo.default)((0,Ho.jsx)("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"CheckBoxOutlineBlank");var Ct={},Wo=Bt;Object.defineProperty(Ct,"__esModule",{value:!0});var Gt=Ct.default=void 0,Uo=Wo(Vt()),Ko=l;Gt=Ct.default=(0,Uo.default)((0,Ko.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckBox");const qo=l.jsx(qt,{fontSize:"small"}),Go=l.jsx(Gt,{fontSize:"small"}),Jo=({staff:e,value:o,onChange:i})=>{const[s,h]=u.useState(""),I=u.useMemo(()=>{if(!s)return e;const c=s.toLowerCase();return e.filter(m=>(m.name||"").toLowerCase().includes(c)||(m.email||"").toLowerCase().includes(c))},[e,s]),b=o.length;return l.jsxs("div",{children:[l.jsxs(Ht,{variant:"body2",children:["Recipients (",b," selected)"]}),l.jsx(_o,{multiple:!0,options:I,getOptionLabel:c=>`${c.name||""} <${c.email||""}>`,value:e.filter(c=>o.includes(c.id)),onChange:(c,m)=>i(m.map(O=>O.id)),inputValue:s,onInputChange:(c,m)=>h(m),renderOption:(c,m,{selected:O})=>l.jsxs("li",{...c,children:[l.jsx(gt,{icon:qo,checkedIcon:Go,style:{marginRight:8},checked:O}),m.name," ",l.jsx("span",{style:{color:"#666",marginLeft:8},children:m.email})]}),renderInput:c=>l.jsx(ze,{...c,label:"Select staff",placeholder:"Search by name or email"})})]})},sa=()=>{const[e,o]=u.useState([]),[i,s]=u.useState([]),[h,I]=u.useState([]),[b,c]=u.useState(null),[m,O]=u.useState(""),[P,L]=u.useState(""),[_,z]=u.useState(!1),[w,ue]=u.useState(""),[be,te]=u.useState(!1),[V,G]=u.useState(!0),[me,he]=u.useState(new Date().toISOString().slice(0,16));u.useEffect(()=>{(async()=>{try{const T=await Lt(ot(He,"staff")),j=[];T.forEach(g=>j.push({id:g.id,...g.data()})),o(j)}catch(T){console.error("failed to load staff",T)}})(),(async()=>{try{const T=await Lt(ot(He,"templates")),j=[];T.forEach(g=>j.push({id:g.id,...g.data()})),I(j)}catch(T){console.error("failed to load templates",T)}})()},[]),u.useEffect(()=>{if(b){const x=h.find(B=>B.id===b);x&&(O(x.subject||""),L(x.htmlBody||x.body||""))}else O(""),L("")},[b,h]);const oe=()=>{if(!i.length)return alert("Select at least one staff to preview");const x=e.find(j=>j.id===i[0]),B=at.render(m,x||{}),T=at.render(P,x||{});alert(`Preview:

Subject:
`+B+`

Body:
`+T)},Y=async()=>{if(!i.length)return alert("Select at least one recipient");if(!b&&(!m||!P))return alert("Subject and body are required");if(_&&!w)return alert("Template name required");const B=eo().currentUser;if(!B){alert("Please sign in to schedule emails");return}te(!0);try{const T=Rt.now(),j=V?T:Rt.fromDate(new Date(me)),g=to(He),ae=ot(He,"email_queue");_&&await Tt(ot(He,"templates"),{name:w,subject:m,htmlBody:P,createdAt:oo(),createdBy:B.uid});for(const H of i){const ie=e.find(S=>S.id===H),W=at.render(m,ie||{}),de=at.render(P,ie||{}),xe={to:ie.email,subject:W,body:de,status:"pending",createdAt:T,scheduledFor:j,sentAt:null,error:null};console.log("Writing to email_queue:",{user:B.uid,docData:xe});try{await Tt(ae,xe)}catch(S){throw console.error("Failed to write email_queue doc",S),S}}te(!1),alert(`${i.length} emails scheduled`),s([]),O(""),L(""),z(!1),ue("")}catch(T){console.error("schedule error",T),te(!1),alert("Failed to schedule emails. See console for details.")}};return l.jsxs(Yt,{children:[l.jsx(Ht,{variant:"h5",mb:2,children:"Compose Email"}),l.jsxs(Pt,{spacing:2,children:[l.jsx(Jo,{staff:e,value:i,onChange:s}),l.jsxs(ze,{select:!0,fullWidth:!0,label:"Template",value:b||"",onChange:x=>c(x.target.value||null),children:[l.jsx(jt,{value:"",children:"(none)"}),h.map(x=>l.jsx(jt,{value:x.id,children:x.name},x.id))]}),!b&&l.jsxs(l.Fragment,{children:[l.jsx(ze,{label:"Subject",fullWidth:!0,value:m,onChange:x=>O(x.target.value)}),l.jsx(ze,{label:"Body",fullWidth:!0,multiline:!0,minRows:6,value:P,onChange:x=>L(x.target.value)}),l.jsx(Dt,{control:l.jsx(gt,{checked:_,onChange:x=>z(x.target.checked)}),label:"Save as template"}),_&&l.jsx(ze,{label:"Template name",value:w,onChange:x=>ue(x.target.value)})]}),b&&l.jsx(l.Fragment,{}),l.jsx(Dt,{control:l.jsx(gt,{checked:V,onChange:x=>G(x.target.checked)}),label:"Send now"}),!V&&l.jsx(ze,{label:"Schedule for",type:"datetime-local",value:me,onChange:x=>he(x.target.value),InputLabelProps:{shrink:!0}}),l.jsxs(Pt,{direction:"row",spacing:2,children:[l.jsx(St,{variant:"outlined",onClick:oe,children:"Preview"}),l.jsx(St,{variant:"contained",onClick:Y,disabled:be,children:be?l.jsx(Zt,{size:20}):"Schedule Email"})]})]})]})};export{sa as ComposeEmail,sa as default};
